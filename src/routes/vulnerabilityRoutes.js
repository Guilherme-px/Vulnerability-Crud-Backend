// express router import
const router = require('express').Router();

// Controllers
const vulnerabilityController = require('../controllers/vulnerabilityController');
const { imageUpload } = require('../helpers/image-upload');

// Route to vulnerability registration
router.post(
    '/register',
    imageUpload.single('evidence'),
    vulnerabilityController.create
);
router.get('/', vulnerabilityController.getVulnerabilities);
router.get('/:id', vulnerabilityController.getVulnerabilitiesById);
router.patch('/:id', vulnerabilityController.editVulnerabilities);
router.delete('/:id', vulnerabilityController.removeVulnerabilities);

module.exports = router;

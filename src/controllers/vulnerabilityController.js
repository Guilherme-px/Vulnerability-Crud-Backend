// Models
const Vulnerability = require('../models/Vulnerability');

module.exports = class VulnerabilityController {
    // Save vulnerability
    static async create(req, res) {
        // request body data
        const vulnerabilitys = { ...req.body };
        // request body image
        const image = req.file;

        // assigns the data to their respective fields in the database
        const saveVulnerability = new Vulnerability({
            title: vulnerabilitys.title,
            description: vulnerabilitys.description,
            criticality: vulnerabilitys.criticality,
            vulnerability: vulnerabilitys.vulnerability,
            evidence: image,
            solution: vulnerabilitys.solution,
        });

        // Save the data in the database
        await saveVulnerability.save();
        // return success message after saving data
        res.status(201).send();
    }
};

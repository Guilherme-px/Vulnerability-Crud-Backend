require('dotenv').config({
    path: process.env.NODE_ENV === 'test' ? '.env.test' : '.env',
});

// Mongoose import
const mongoose = require('mongoose');

async function database() {
    await mongoose.connect(
        `mongodb://${process.env.DB_HOST}:${process.env.DB_PORT}/${process.env.DB_NAME}`,
        {
            // If the environment variable is equal to noAuth, no authentication is needed
            authSource:
                process.env.DB_AUTH === 'noAuth' ? null : process.env.DB_AUTH,
            user: process.env.DB_AUTH === 'noAuth' ? null : process.env.DB_USER,
            pass: process.env.DB_AUTH === 'noAuth' ? null : process.env.DB_PASS,
        }
    );
    console.log('connect db');
}

database().catch((err) => console.log(err));

module.exports = mongoose;
